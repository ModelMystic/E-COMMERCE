<%- include('partials/shopfinalHead') %>



<body class="bg-gray-100">
    <div class="container mx-auto p-4">
        <h1 class="text-2xl font-semibold mb-4">Select Delivery Address</h1>
        
        <!-- Address Selection Dropdown -->
        <div class="mb-4">
            <label for="address" class="block text-gray-700 text-sm font-bold mb-2">Select Address:</label>
            <select id="address" class="block w-full bg-white border border-gray-300 rounded-md py-2 px-3 focus:outline-none focus:ring focus:ring-indigo-300">
                <option value="1">--none--</option>
                
                    <% addresses.forEach(address => { %>
                        <option value="1">
                        <div class="card" style="margin: 10px;">
                            <div class="row no-gutters">
                                
                                <div class="col">
                                    <div class="card-block px-2" style="margin: 8px; position: relative;">
                                        <h4 class="card-title"><%= address.fullname %></h4>
                                        <p class="card-text"><%= address.houseno %>, <%= address.area %></p>
                                        <p class="card-text"><%= address.city %>, <%= address.state %>, <%= address.pincode %></p>
                                        <p class="card-text">Phone number: <%= address.mobilenumber %></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </option>
                    <% }) %>
               
            </select>
            <br>
            <a href="/addNewAddress/fullCart">
            <button id="add-address-btn" class="bg-green-500 text-white font-semibold py-2 px-4 rounded-full ml-2">
                Add New Address
            </button>
        </a>
        </div>
        
        <!-- Display Chosen Address -->
        <div class="mb-4">
            <h2 class="text-lg font-semibold mb-2">Selected Address:</h2>
            <p id="selected-address" class="text-gray-700"></p>
        </div>
        
        <!-- Order Summary -->
        <div>
            <h2 class="text-lg font-semibold mb-2">Order Summary:</h2>
            <ul id="order-summary" class="mt-4">
                <% cart.forEach(product => { %>
                    <li><%= product.name %> - $<%= product.price %></li>
                <% }) %>
                <!-- Items in the order will be dynamically added here -->
                <!-- Example:
                <li>2 x Product Name - $24.99</li>
                <li>1 x Another Product - $12.49</li>
                -->
            </ul>
        </div>

        <div>
            <br><br>
            <h2 class="text-lg font-semibold mb-2">Total Amount: $<%= amount %></h2>
        </div>
        
        <!-- Checkout Button -->
        <div class="mt-4">
            <button id="checkout-btn" class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:ring focus:ring-indigo-300">Proceed to Checkout</button>
        </div>
    </div>
    
    <script>
        // JavaScript to update the selected address when the dropdown changes
        const addressDropdown = document.getElementById('address');
        const selectedAddress = document.getElementById('selected-address');
        
        addressDropdown.addEventListener('change', () => {
            selectedAddress.textContent = addressDropdown.options[addressDropdown.selectedIndex].text;
        });
        
        // JavaScript for handling checkout logic
        const checkoutButton = document.getElementById('checkout-btn');
        
        checkoutButton.addEventListener('click', () => {
            const selectedAddressValue = addressDropdown.value;
            
            // You can add logic here to handle the checkout process using the selected address value
            // For example, you can send this information to a server for processing.
            
            // For now, let's just display a simple message
            alert(`Order will be delivered to:\n${selectedAddress.textContent}`);
        });
    </script>
</body>

<%- include('partials/footer') %>